!function(n){function a(a){for(var t,o,c=a[0],l=a[1],i=a[2],r=0,k=[];r<c.length;r++)o=c[r],Object.prototype.hasOwnProperty.call(p,o)&&p[o]&&k.push(p[o][0]),p[o]=0;for(t in l)Object.prototype.hasOwnProperty.call(l,t)&&(n[t]=l[t]);for(u&&u(a);k.length;)k.shift()();return e.push.apply(e,i||[]),s()}function s(){for(var n,a=0;a<e.length;a++){for(var s=e[a],t=!0,c=1;c<s.length;c++){var l=s[c];0!==p[l]&&(t=!1)}t&&(e.splice(a--,1),n=o(o.s=s[0]))}return n}var t={},p={8:0,22:0},e=[];function o(a){if(t[a])return t[a].exports;var s=t[a]={i:a,l:!1,exports:{}};return n[a].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.e=function(){return Promise.resolve()},o.m=n,o.c=t,o.d=function(n,a,s){o.o(n,a)||Object.defineProperty(n,a,{enumerable:!0,get:s})},o.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},o.t=function(n,a){if(1&a&&(n=o(n)),8&a)return n;if(4&a&&"object"==typeof n&&n&&n.__esModule)return n;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:n}),2&a&&"string"!=typeof n)for(var t in n)o.d(s,t,function(a){return n[a]}.bind(null,t));return s},o.n=function(n){var a=n&&n.__esModule?function(){return n.default}:function(){return n};return o.d(a,"a",a),a},o.o=function(n,a){return Object.prototype.hasOwnProperty.call(n,a)},o.p="/san-ssr/";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=a,c=c.slice();for(var i=0;i<c.length;i++)a(c[i]);var u=l;e.push([58,0]),s()}({19:function(n,a,s){"use strict";s.r(a),function(n){s.d(a,"default",(function(){return c}));var t,p,e,o=s(0);class c extends o.a{inited(){n.hub&&n.hub.fire&&n.hub.fire("changed",{level:0,children:[{level:2,title:"问题",hash:"%E9%97%AE%E9%A2%98"},{level:2,title:"使用 outputData 精简数据输出",hash:"%E4%BD%BF%E7%94%A8-outputdata-%E7%B2%BE%E7%AE%80%E6%95%B0%E6%8D%AE%E8%BE%93%E5%87%BA"}]})}}e={},(p="components")in(t=c)?Object.defineProperty(t,p,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[p]=e}.call(this,s(2))},45:function(n,a){n.exports=' <div class="content markdown-content"><div class="markdown"><h1 id="%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E8%BE%93%E5%87%BA">自定义数据输出</h1> <blockquote> <p>Added in: v5.3.0</p> </blockquote> <p>San-SSR 会将数据以注释的形式输出在 HTML 结果中，用于在浏览器中反解，例如：</p> <p>组件：</p> <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'san\'</span><span class="token punctuation">)</span>\n<span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\nMyComponent<span class="token punctuation">.</span>template <span class="token operator">=</span> <span class="token string">\'&lt;div>&#123;&#123;staff[0].first}} &#123;&#123;staff.0.last}}&lt;/div>\'</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> exports <span class="token operator">=</span> MyComponent</code></pre> <p>数据：</p> <pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>\n    <span class="token property">"staff"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>\n        <span class="token property">"first"</span><span class="token operator">:</span> <span class="token string">"Berg"</span><span class="token punctuation">,</span>\n        <span class="token property">"last"</span><span class="token operator">:</span> <span class="token string">"Lay"</span>\n    <span class="token punctuation">}</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span></code></pre> <p>会得到如下结果，注意到数据以注释方式输出在了 HTML 中：</p> <pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--s-data:{"staff":[{"first":"Berg","last":"Lay"}]}--\x3e</span>Berg Lay<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre> <h2 id="%E9%97%AE%E9%A2%98">问题</h2> <p>当我们渲染的内容大部分为静态内容时，数据会在输出的 HTML 中占用较大体积。一个极端的例子是使用 <code>s-html</code> 渲染大量内容。</p> <p>组件：</p> <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> san <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'san\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> MyComponent <span class="token operator">=</span> san<span class="token punctuation">.</span><span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">\'&lt;div id="output-data-outer">\'</span>\n        <span class="token operator">+</span> <span class="token string">\'&lt;b>&#123;&#123;title}}&lt;/b>\'</span>\n        <span class="token operator">+</span> <span class="token string">\'&lt;div s-html="&#123;&#123;content}}">&lt;/div>\'</span>\n        <span class="token operator">+</span> <span class="token string">\'&lt;/div>\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nexports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MyComponent<span class="token punctuation">;</span></code></pre> <p>数据：</p> <pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>\n    <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"The Last of the Mohicans"</span><span class="token punctuation">,</span>\n    <span class="token property">"content"</span><span class="token operator">:</span> "&lt;p>The Last of the Mohicans is a <span class="token number">1992</span> American epic historical drama film set \n    in <span class="token number">1757</span> during the French and Indian War. &lt;/p>&lt;p>It was directed by Michael Mann and was \n    based on the <span class="token number">1826</span> novel The Last of the Mohicans<span class="token operator">:</span> A Narrative of <span class="token number">1757</span> by James Fenimore \n    Cooper and the <span class="token number">1936</span> film adaptation<span class="token punctuation">,</span> owing more to the film than the novel. The film stars \n    Daniel Day-Lewis and Madeleine Stowe<span class="token punctuation">,</span> with Jodhi May<span class="token punctuation">,</span> Russell Means<span class="token punctuation">,</span> Wes Studi<span class="token punctuation">,</span> Eric \n    Schweig<span class="token punctuation">,</span> and Steven Waddington in supporting roles.&lt;/p>"\n<span class="token punctuation">}</span></code></pre> <p>如果直接使用 San-SSR 渲染，会得到如下结果：</p> <pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>output-data-outer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment">&lt;!--s-data:{"title":"The Last of the Mohicans","content":"&lt;p>The \n    Last of the Mohicans is a 1992 American epic historical drama film set in 1757 during the \n    French and Indian War. &lt;/p>&lt;p>It was directed by Michael Mann and was based on the 1826 \n    novel The Last of the Mohicans: A Narrative of 1757 by James Fenimore Cooper and the 1936 \n    film adaptation, owing more to the film than the novel. The film stars Daniel Day-Lewis and \n    Madeleine Stowe, with Jodhi May, Russell Means, Wes Studi, Eric Schweig, and Steven \n    Waddington in supporting roles.&lt;/p>"}--\x3e</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">></span></span>The Last of the Mohicans<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>The Last of \n    the Mohicans is a 1992 American epic historical drama film set in 1757 during the French \n    and Indian War. <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>It was directed by Michael Mann and was based on the 1826 novel The \n    Last of the Mohicans: A Narrative of 1757 by James Fenimore Cooper and the 1936 film \n    adaptation, owing more to the film than the novel. The film stars Daniel Day-Lewis and \n    Madeleine Stowe, with Jodhi May, Russell Means, Wes Studi, Eric Schweig, and Steven \n    Waddington in supporting roles.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre> <h2 id="%E4%BD%BF%E7%94%A8-outputdata-%E7%B2%BE%E7%AE%80%E6%95%B0%E6%8D%AE%E8%BE%93%E5%87%BA">使用 <code>outputData</code> 精简数据输出</h2> <p>在调用 <code>render</code> 函数时，可以通过传入 <code>outputData</code> 的方式来控制数据产出。此时反解阶段会直接使用 HTML 中的现有数据，请自己负责正确性。</p> <p><code>outputData</code> 支持两种类型：</p> <ul> <li><code>Object</code>：代替 data，直接使用该字段输出在 HTML 中。</li> <li><code>Function</code>：传入 data，输出结果输出在 HTML 中。</li> </ul> <p>还是上面的组件，这里我们在调用 render 函数时，可以传入 <code>outputData</code> 参数来控制数据输出：</p> <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// 对象形式</span>\n<span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">outputData</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token literal-property property">title</span><span class="token operator">:</span> data<span class="token punctuation">.</span>title\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre> <pre class="language-javascript"><code class="language-javascript"><span class="token comment">// 函数形式</span>\n<span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n    <span class="token function">outputData</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token punctuation">{</span>\n            <span class="token literal-property property">title</span><span class="token operator">:</span> data<span class="token punctuation">.</span>title\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre> <p>输出的 HTML 内容中不再有 content 数据，体积得到了显著改善：</p> <pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>output-data-outer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment">&lt;!--s-data:{"title":"The Last of the Mohicans"}--\x3e</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">></span></span>The Last of the \n    Mohicans<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>The Last of the Mohicans is a 1992 American epic historical drama film \n    set in 1757 during the French and Indian War. <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>It was directed by Michael Mann and was \n    based on the 1826 novel The Last of the Mohicans: A Narrative of 1757 by James Fenimore \n    Cooper and the 1936 film adaptation, owing more to the film than the novel. The film stars \n    Daniel Day-Lewis and Madeleine Stowe, with Jodhi May, Russell Means, Wes Studi, Eric Schweig, \n    and Steven Waddington in supporting roles.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre> </div></div> '},58:function(n,a,s){var t=s(1),p=s(45),e=s(19).default;n.exports=s(19),n.exports.default=t(e,p,[])}});